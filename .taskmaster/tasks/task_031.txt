# Task ID: 31
# Title: Add comprehensive testing suite
# Status: pending
# Dependencies: 18, 19, 22, 23, 24, 25, 26, 27
# Priority: high
# Description: Create unit, integration, and E2E tests with high code coverage
# Details:
Write unit tests for all handlers. Create integration tests for HTMX interactions. Implement E2E tests with Playwright. Test session management. Test SSE connections. Create visual regression tests. Test accessibility with axe-core. Achieve 80%+ coverage.

# Test Strategy:
Run tests in CI on every commit. Test on multiple browsers. Test on multiple devices. Load test with k6 (100 users). Security test with OWASP ZAP.

Visual Verification (Playwright MCP):
- Capture screenshots at key interaction points
- Establish visual regression baselines for comparison
- Test across viewports: mobile (375px), tablet (768px), desktop (1440px), wide (1920px)
- Verify dark mode rendering (if applicable)
- Test HTMX partial updates (ensure no layout shift or flashing)
- Validate accessibility: focus indicators, color contrast ratios
- Screenshot error states and empty states
- Verify loading states and skeleton screens render correctly
- Use Playwright MCP to navigate, interact, and capture all states
- Store screenshots in tests/visual-regression/baselines/
- Compare against baselines on subsequent runs (fail on >5% diff)
- Screenshot: Test coverage report
- Screenshot: E2E test running in Playwright
- Screenshot: Visual regression diff report
- Screenshot: Accessibility test results (axe-core)
- Screenshot: Load test dashboard (k6)
- Screenshot: Security scan results (OWASP ZAP)
- Capture all test failure screenshots automatically
- Verify all critical user flows pass E2E tests
- Verify visual regression baselines are updated only when approved
- Test suite runs in < 10 minutes
