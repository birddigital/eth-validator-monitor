# ============================================================================
# Ethereum Validator Monitor - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values
# Required variables are marked with [REQUIRED]
# Optional variables have sensible defaults

# ============================================================================
# Server Configuration
# ============================================================================

# HTTP server port for the GraphQL API
# Default: 8080
HTTP_PORT=8080

# Gin framework mode: debug, release, or test
# - debug: verbose logging, useful for development
# - release: optimized for production, minimal logging
# - test: for running tests
# Default: release
GIN_MODE=release

# ============================================================================
# Rate Limiting Configuration
# ============================================================================

# Enable/disable rate limiting
# Set to false in development, true in production
# Default: true
RATE_LIMIT_ENABLED=true

# Requests per second allowed per IP address
# Adjust based on expected legitimate traffic patterns
# Default: 10.0
RATE_LIMIT_RPS=10.0

# Burst capacity - allows temporary traffic spikes
# Should be higher than RPS to accommodate bursts
# Default: 20
RATE_LIMIT_BURST=20

# ============================================================================
# CORS (Cross-Origin Resource Sharing) Configuration
# ============================================================================

# Enable/disable CORS
# Set to true if your frontend is on a different domain
# Default: true
CORS_ENABLED=true

# Allowed origins (comma-separated)
# IMPORTANT: Never use * in production with credentials
# Examples:
#   - Development: http://localhost:3000,http://localhost:5173
#   - Production: https://yourdomain.com,https://app.yourdomain.com
# Default: http://localhost:3000
CORS_ALLOWED_ORIGINS=http://localhost:3000

# Allowed HTTP methods (comma-separated)
# Default: GET,POST,OPTIONS
CORS_ALLOWED_METHODS=GET,POST,OPTIONS

# Allowed request headers (comma-separated)
# Default: Content-Type,Authorization,X-API-Key,X-Requested-With
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-API-Key,X-Requested-With

# Preflight request cache duration in seconds
# How long browsers cache OPTIONS preflight responses
# Default: 300 (5 minutes)
CORS_MAX_AGE=300

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================

# Database host
# Default: localhost
DB_HOST=localhost

# Database port
# Default: 5432
DB_PORT=5432

# Database username [REQUIRED]
# Example: validator_user
DB_USER=your_db_user

# Database password [REQUIRED]
# Example: your_secure_password
DB_PASSWORD=your_db_password

# Database name
# Default: validator_monitor
DB_NAME=validator_monitor

# SSL mode for database connections
# Options: disable, allow, prefer, require, verify-ca, verify-full
# - disable: No SSL (use only in development)
# - allow: Try SSL, fallback to non-SSL
# - prefer: Try SSL first, fallback to non-SSL
# - require: SSL required but don't verify certificate
# - verify-ca: Verify certificate authority
# - verify-full: Full certificate verification (recommended for production)
# IMPORTANT: Production environments must use require, verify-ca, or verify-full
# Default: require
DB_SSL_MODE=require

# SSL certificate paths (required for verify-ca and verify-full modes)
# Path to client certificate (optional)
DB_SSL_CERT=

# Path to client private key (optional)
DB_SSL_KEY=

# Path to root CA certificate for verification (required for verify-ca/verify-full)
DB_SSL_ROOT_CERT=

# Environment mode (affects SSL enforcement)
# - production: Enforces secure SSL modes (require, verify-ca, verify-full)
# - development: Allows any SSL mode
ENV=development

# ============================================================================
# Redis Configuration
# ============================================================================

# Redis server address in format host:port
# Default: localhost:6379
REDIS_ADDR=localhost:6379

# Redis password (leave empty if no password)
# Default: (empty)
REDIS_PASSWORD=

# Redis database number (0-15)
# Default: 0
REDIS_DB=0

# ============================================================================
# Beacon Chain Configuration
# ============================================================================

# Beacon node API URL [REQUIRED]
# This is the Ethereum Beacon Chain node that the monitor will query
# Examples:
#   - Local node: http://localhost:5052
#   - Prysm: http://localhost:3500
#   - Lighthouse: http://localhost:5052
#   - Remote node: https://beacon-node.example.com
# Default: http://localhost:5052
BEACON_NODE_URL=http://localhost:5052

# ============================================================================
# Monitoring Configuration
# ============================================================================

# Prometheus metrics exposition port
# The /metrics endpoint will be available at this port
# Default: 9090
PROMETHEUS_PORT=9090

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level: debug, info, warn, error
# - debug: verbose logging for development
# - info: standard logging for production
# - warn: only warnings and errors
# - error: only errors
# Default: info
LOG_LEVEL=info

# Log format: json, console
# - json: structured JSON output (recommended for production)
# - console: human-readable colored output (recommended for development)
# Default: json
LOG_FORMAT=json

# Log output destination: stdout or file path
# - stdout: output to standard output (container-friendly)
# - /path/to/file.log: write to a file with rotation
# Default: stdout
LOG_OUTPUT_PATH=stdout

# Log rotation settings (only used when LOG_OUTPUT_PATH is a file)
# Maximum size in megabytes before rotation
# Default: 100
LOG_MAX_SIZE_MB=100

# Maximum number of old log files to retain
# Default: 3
LOG_MAX_BACKUPS=3

# Maximum age in days for old log files
# Default: 28
LOG_MAX_AGE_DAYS=28

# Compress rotated log files
# Default: true
LOG_COMPRESS=true

# ============================================================================
# JWT Authentication Configuration (Optional)
# ============================================================================

# JWT secret key for signing tokens [OPTIONAL - if not set, auth is disabled]
#
# SECURITY REQUIREMENTS:
# - MUST be at least 32 characters (256 bits minimum)
# - MUST be cryptographically random (high entropy)
# - NEVER use common words, patterns, or default values
# - NEVER commit actual secrets to version control
#
# GENERATE A SECURE SECRET:
#   Using openssl (recommended):
#     openssl rand -base64 32
#
#   Using Python:
#     python3 -c "import secrets; print(secrets.token_urlsafe(32))"
#
#   Using Node.js:
#     node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
#
# The application will validate the secret on startup and REFUSE TO START if:
# - Secret is missing when authentication features are used
# - Secret is too short (< 32 characters)
# - Secret uses common weak patterns (e.g., "secret", "password", "test")
# - Secret has low entropy (insufficient randomness)
#
# Example (DO NOT USE THIS - generate your own):
#   JWT_SECRET_KEY=YourSecureRandomBase64EncodedSecretHereMin32Chars
#
JWT_SECRET_KEY=

# JWT token issuer (identifies your application)
# Default: eth-validator-monitor
JWT_ISSUER=eth-validator-monitor

# Access token expiration duration
# Format: <number><unit> where unit is: ns, us, ms, s, m, h
# Examples: 15m (15 minutes), 1h (1 hour), 30s (30 seconds)
# Default: 15m
JWT_ACCESS_TOKEN_DURATION=15m

# Refresh token expiration duration
# Must be longer than access token duration
# Default: 168h (7 days)
JWT_REFRESH_TOKEN_DURATION=168h

# ============================================================================
# Session Authentication Configuration (Optional)
# ============================================================================

# Session secret key for signing cookies [OPTIONAL - if not set, session auth is disabled]
#
# SECURITY REQUIREMENTS:
# - MUST be at least 32 characters (256 bits minimum)
# - MUST be cryptographically random (high entropy)
# - NEVER use common words, patterns, or default values
# - NEVER commit actual secrets to version control
#
# GENERATE A SECURE SECRET:
#   Using openssl (recommended):
#     openssl rand -base64 32
#
#   Using Python:
#     python3 -c "import secrets; print(secrets.token_urlsafe(32))"
#
#   Using Node.js:
#     node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
#
# The application will validate the secret on startup and REFUSE TO START if:
# - Secret is missing when session features are used
# - Secret is too short (< 32 characters)
# - Secret uses common weak patterns (e.g., "secret", "password", "test")
# - Secret has low entropy (insufficient randomness)
#
# Example (DO NOT USE THIS - generate your own):
#   SESSION_SECRET_KEY=YourSecureRandomBase64EncodedSecretHereMin32Chars
#
SESSION_SECRET_KEY=

# Session maximum age (expiration time)
# Format: <number><unit> where unit is: ns, us, ms, s, m, h
# Examples: 7d would be 168h, 1d would be 24h
# Default: 168h (7 days)
SESSION_MAX_AGE=168h

# Only send cookies over HTTPS
# IMPORTANT: Set to true in production
# Default: true
SESSION_SECURE=true

# Prevent JavaScript access to cookies (XSS protection)
# Default: true (recommended for security)
SESSION_HTTP_ONLY=true

# SameSite cookie attribute for CSRF protection
# Options: Strict, Lax, None
# - Strict: Cookie only sent for same-site requests (most secure)
# - Lax: Cookie sent for top-level navigations (recommended)
# - None: Cookie sent for all requests (requires SESSION_SECURE=true)
# Default: Lax
SESSION_SAME_SITE=Lax
